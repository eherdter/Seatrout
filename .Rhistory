data(ca533)
library(dplR)
install.packages("dplR")
data(ca533)
data()
data(treering)
colnames(data)
tree <- data(treering)
colnames(tree)
treering
data(dplR = .packages(all.available=TRUE))
citation(package="nlstools")
citation(package="fishmethods")
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
setwd("~/Desktop/Github Repo/Seatrout")
# load all IOA for YOY. Data are from FIM.
TB_RIV <- read.csv("TB_RIV.csv", check.names=FALSE)
TB_BAY <- read.csv("TB_BAY.csv", check.names=FALSE)
AP_BAY <- read.csv("AP_BAY.csv", check.names=FALSE) #there are no IOA for YOY in the river
CH_BAY <- read.csv("CH_BAY.csv", check.names=FALSE)
CH_RIV <- read.csv("CH_RIV.csv", check.names=FALSE)
CK_BAY <- read.csv("CK_BAY.csv", check.names=FALSE)
CK_RIV <- read.csv("CK_RIV.csv", check.names=FALSE)
IR_BAY <- read.csv("IR_BAY.csv", check.names=FALSE)
JX     <- read.csv("JX.csv", check.names=FALSE)
#melt the data so that the sets can easily be fead into ddply
library(reshape2)
meltTB_RIV <- melt(TB_RIV)
meltTB_BAY <- melt(TB_BAY)
meltAP_BAY <- melt(AP_BAY)
meltCH_BAY <- melt(CH_BAY)
meltCH_RIV <- melt(CH_RIV)
meltCK_BAY <- melt(CK_BAY)
meltCK_RIV <- melt(CK_RIV)
meltIR_BAY <- melt(IR_BAY)
meltJX     <- melt(JX)
#re-name column headings
colnames(meltTB_RIV) <- c("Year", "BootstrapRealization")
colnames(meltTB_BAY) <- c("Year", "BootstrapRealization")
colnames(meltAP_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCH_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCH_RIV) <- c("Year", "BootstrapRealization")
colnames(meltCK_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCK_RIV) <- c("Year", "BootstrapRealization")
colnames(meltIR_BAY) <- c("Year", "BootstrapRealization")
colnames(meltJX)     <- c("Year", "BootstrapRealization")
# identify median and quantiles as done in the annual report for FIM
library(plyr)
TBRIV_sum <- ddply(meltTB_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
TBBAY_sum <- ddply(meltTB_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
APBAY_sum <- ddply(meltAP_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHBAY_sum <- ddply(meltCH_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHRIV_sum <- ddply(meltCH_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKBAY_sum <- ddply(meltCK_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKRIV_sum <- ddply(meltCK_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
IRBAY_sum <- ddply(meltIR_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
JX_sum    <- ddply(meltJX,     .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
View(TBRIV_sum)
View(TBRIV_sum)
help(scale)
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
plotTBRIV <- TBRIV_SUM[;1:2]
plotTBRIV <- TBRIV_SUM[,1:2]
TBRIV_sum <- ddply(meltTB_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
plotTBRIV <- TBRIV_SUM[,1:2]
plotTBRIV <- TBRIV_sum[,1:2]
plot(plotTBRIV)
plotTBRIV <- data.frame(TBRIV_sum[,1:2])
plot(plotTBRIV)
plot(plotTBRIV)
plotTBRIV <- as.matrix(TBRIV_sum[,1:2])
plot(plotTBRIV)
rec
help(lag.plot1)
install.packages("astsa")
library("astsa", lib.loc="~/Library/R/3.0/library")
redTBRIV <- as.matrix(TBRIV_sum[,1:2])
redTBBAY <- as.matrix(TBBAY_sum[,1:2])
redAPBAY <- as.matrix(APBAY_sum[,1:2])
redCHBAY <- as.matrix(CHBAY_sum[,1:2])
redCHRIV <- as.matrix(CHRIV_sum[,1:2])
redCKBAY <- as.matrix(CKBAY_sum[,1:2])
redCKRIV <- as.matrix(CKRIV_sum[,1:2])
redIRBAY <- as.matrix(IRBAY_sum[,1:2])
redJX    <- as.matrix(JX_sum[,1:2])
plot(redTBRIV)
plot(redTBBAY)
plot(redAPBAY)
plot(redCHBAY)
plot(redCHRIV)
plot(redCKBAY)
plot(redCKRIV)
plot(redIRBAY)
plot(redJX)
#lagged scatterplots of each time series
library(astsa)
lag.plot1(redTBRIV, 5, smooth=FLASE)
library(astsa)
lag1.plot(redTBRIV, 5, corr=TRUE, smooth=FLASE)
redTBRIV <- as.numeric(TBRIV_sum[,1:2])
redTBRIV[,1:2] <- as.numeric(TBRIV_sum[,1:2])
redTBRIV <- as.numeric(as.character(TBRIV_sum[,1:2]))
redTBRIV <- as.numeric(as.character(TBRIV_sum[1:2]))
redTBRIV <- as.numeric(as.character(TBRIV_sum[,c(1:2)]))
TBRIV_sum <- ddply(meltTB_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
as.numeric(as.character(TBRIV_sum$Year))
redTBRIV <- TBRIV_sum[,1:2]
TBRIV_sum$Year <- as.numeric(as.character(TBRIV_sum$Year))
View(TBRIV_sum)
TBBAY_sum$Year <- as.numeric(as.character(TBBAY_sum$Year))
plot(TBBAY_sum$Year~TBBAY_sum$median)
plot(TBBAY_sum$median~TBBAY_sum$year)
plot(TBBAY_sum$median~TBBAY_sum$Year)
plot(TBRIV_sum$median~TBRIV_sum$Year)
plot(TBBAY_sum$median~TBBAY_sum$Year)
plot(APBAY_sum$median~APBAY_sum$Year)
plot(CHBAY_sum$median~CHBAY_sum$Year)
plot(CHRIV_sum$median~CHRIV_sum$Year)
plot(CKBAY_sum$median~CKBAY_sum$Year)
plot(CKRIV_sum$median~CKRIV_sum$Year)
plot(IRBAY_sum$median~IRBAY_sum$Year)
plot(JX_sum$median~JX_sum$Year)
TBBAY_sum$Year <- as.numeric(as.character(TBBAY_sum$Year))
TBRIV_sum$Year <- as.numeric(as.character(TBRIV_sum$Year))
APBAY_sum$Year <- as.numeric(as.character(APBAY_sum$Year))
CHBAY_sum$Year <- as.numeric(as.character(CHBAY_sum$Year))
CHRIV_sum$Year <- as.numeric(as.character(CHRIV_sum$Year))
CKBAY_sum$Year <- as.numeric(as.character(CKBAY_sum$Year))
CKRIV_sum$Year <- as.numeric(as.character(CKRIV_sum$Year))
IRBAY_sum$Year <- as.numeric(as.character(IRBAY_sum$Year))
JX_sum$Year <- as.numeric(as.character(JX_sum$Year))
plot(TBRIV_sum$median~TBRIV_sum$Year)
plot(TBBAY_sum$median~TBBAY_sum$Year)
plot(APBAY_sum$median~APBAY_sum$Year)
plot(CHBAY_sum$median~CHBAY_sum$Year)
plot(CHRIV_sum$median~CHRIV_sum$Year)
plot(CKBAY_sum$median~CKBAY_sum$Year)
plot(CKRIV_sum$median~CKRIV_sum$Year)
plot(IRBAY_sum$median~IRBAY_sum$Year)
plot(JX_sum$median~JX_sum$Year)
View(CH_RIV)
TBRIV_sum <- ddply(meltTB_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
TBBAY_sum <- ddply(meltTB_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
APBAY_sum <- ddply(meltAP_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHBAY_sum <- ddply(meltCH_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHRIV_sum <- ddply(meltCH_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKBAY_sum <- ddply(meltCK_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKRIV_sum <- ddply(meltCK_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
IRBAY_sum <- ddply(meltIR_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
JX_sum    <- ddply(meltJX,     .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
TBBAY_sum$Year <- as.numeric(as.character(TBBAY_sum$Year))
TBRIV_sum$Year <- as.numeric(as.character(TBRIV_sum$Year))
APBAY_sum$Year <- as.numeric(as.character(APBAY_sum$Year))
CHBAY_sum$Year <- as.numeric(as.character(CHBAY_sum$Year))
CHRIV_sum$Year <- as.numeric(as.character(CHRIV_sum$Year))
CKBAY_sum$Year <- as.numeric(as.character(CKBAY_sum$Year))
CKRIV_sum$Year <- as.numeric(as.character(CKRIV_sum$Year))
IRBAY_sum$Year <- as.numeric(as.character(IRBAY_sum$Year))
JX_sum$Year <- as.numeric(as.character(JX_sum$Year))
plot(TBRIV_sum$median~TBRIV_sum$Year)
plot(TBBAY_sum$median~TBBAY_sum$Year)
plot(APBAY_sum$median~APBAY_sum$Year)
plot(CHBAY_sum$median~CHBAY_sum$Year)
plot(CHRIV_sum$median~CHRIV_sum$Year)
plot(CKBAY_sum$median~CKBAY_sum$Year)
plot(CKRIV_sum$median~CKRIV_sum$Year)
plot(IRBAY_sum$median~IRBAY_sum$Year)
plot(JX_sum$median~JX_sum$Year)
View(meltAP_BAY)
View(meltAP_BAY)
View(AP_BAY)
View(AP_BAY)
meltAP_BAY <- melt(AP_BAY[,3:19])
View(meltAP_BAY)
View(meltAP_BAY)
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
TB_RIV <- read.csv("TB_RIV.csv", check.names=FALSE)
TB_BAY <- read.csv("TB_BAY.csv", check.names=FALSE)
AP_BAY <- read.csv("AP_BAY.csv", check.names=FALSE) #there are no IOA for YOY in the river
CH_BAY <- read.csv("CH_BAY.csv", check.names=FALSE)
CH_RIV <- read.csv("CH_RIV.csv", check.names=FALSE)
CK_BAY <- read.csv("CK_BAY.csv", check.names=FALSE)
CK_RIV <- read.csv("CK_RIV.csv", check.names=FALSE)
IR_BAY <- read.csv("IR_BAY.csv", check.names=FALSE)
JX     <- read.csv("JX.csv", check.names=FALSE)
library(reshape2)
meltTB_RIV <- melt(TB_RIV)
meltTB_BAY <- melt(TB_BAY)
meltAP_BAY <- melt(AP_BAY[,3:19]) # no data for 1996 or 1997
meltCH_BAY <- melt(CH_BAY)
meltCH_RIV <- melt(CH_RIV)
meltCK_BAY <- melt(CK_BAY)
meltCK_RIV <- melt(CK_RIV)
meltIR_BAY <- melt(IR_BAY)
meltJX     <- melt(JX[, 6:19]) # no data for 1996-2000
colnames(meltTB_RIV) <- c("Year", "BootstrapRealization")
colnames(meltTB_BAY) <- c("Year", "BootstrapRealization")
colnames(meltAP_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCH_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCH_RIV) <- c("Year", "BootstrapRealization")
colnames(meltCK_BAY) <- c("Year", "BootstrapRealization")
colnames(meltCK_RIV) <- c("Year", "BootstrapRealization")
colnames(meltIR_BAY) <- c("Year", "BootstrapRealization")
colnames(meltJX)     <- c("Year", "BootstrapRealization")
View(meltTB_RIV)
View(meltTB_RIV)
library(plyr)
TBRIV_sum <- ddply(meltTB_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
TBBAY_sum <- ddply(meltTB_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
APBAY_sum <- ddply(meltAP_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHBAY_sum <- ddply(meltCH_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CHRIV_sum <- ddply(meltCH_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKBAY_sum <- ddply(meltCK_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
CKRIV_sum <- ddply(meltCK_RIV, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
IRBAY_sum <- ddply(meltIR_BAY, .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
JX_sum    <- ddply(meltJX,     .(Year), summarise, median=median(BootstrapRealization), lower=quantile(BootstrapRealization, .25, na.rm=TRUE), upper=quantile(BootstrapRealization, .75, na.rm=TRUE))
TBBAY_sum$Year <- as.numeric(as.character(TBBAY_sum$Year))
TBRIV_sum$Year <- as.numeric(as.character(TBRIV_sum$Year))
APBAY_sum$Year <- as.numeric(as.character(APBAY_sum$Year))
CHBAY_sum$Year <- as.numeric(as.character(CHBAY_sum$Year))
CHRIV_sum$Year <- as.numeric(as.character(CHRIV_sum$Year))
CKBAY_sum$Year <- as.numeric(as.character(CKBAY_sum$Year))
CKRIV_sum$Year <- as.numeric(as.character(CKRIV_sum$Year))
IRBAY_sum$Year <- as.numeric(as.character(IRBAY_sum$Year))
JX_sum$Year <- as.numeric(as.character(JX_sum$Year))
#plot
plot(TBRIV_sum$median~TBRIV_sum$Year)
plot(TBBAY_sum$median~TBBAY_sum$Year)
plot(APBAY_sum$median~APBAY_sum$Year)
plot(CHBAY_sum$median~CHBAY_sum$Year)
plot(CHRIV_sum$median~CHRIV_sum$Year)
plot(CKBAY_sum$median~CKBAY_sum$Year)
plot(CKRIV_sum$median~CKRIV_sum$Year)
plot(IRBAY_sum$median~IRBAY_sum$Year)
plot(JX_sum$median~JX_sum$Year)
lag1.plot.(TBRIV_sum, 5, corr=TRUE, smooth=FLASE)
library(astsa)
lag1.plot.(TBRIV_sum, 5, corr=TRUE, smooth=FLASE)
lag1.plot(TBRIV_sum, 5, corr=TRUE, smooth=FLASE)
lag1.plot(TBRIV_sum$median, 5, corr=TRUE, smooth=FLASE)
lag1.plot(TBRIV_sum$median, 5, corr=TRUE, smooth=FALSE)
lag1.plot(TBRIV_sum$median, 5, corr=TRUE, smooth=TRUE)
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
rec
help(rec)
acf2(TBRIV_sum$median)
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
source('~/Desktop/Github Repo/Seatrout/Seatrout IOA.R')
